<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">
    <meta http-Equiv="Expires" Content="0" />
    <title>定时任务列表</title>
    <link rel="stylesheet" href="/lib/layui/css/layui.css"/>
    
</head>
<body>
<div style="padding: 20px;margin-top: 50px;">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon">&#xe68e;</i>
                    <span>首页 / 定时任务</span>
                </div>
                <div class="layui-card-body">               
						<button class="layui-btn layui-btn-sm" id="add"><i class="layui-icon">&#xe654;</i>添加 </button>
                </div>
            </div>
        </div>
    </div>

	<table class="layui-table">
	  <colgroup>
	    <col width="150">
	    <col width="200">
	    <col>
	  </colgroup>
	  <thead>
	    <tr>
	      <th>昵称</th>
	      <th>加入时间</th>
	      <th>签名</th>
	    </tr> 
	  </thead>
	  <tbody>
	    <tr>
	      <td>贤心</td>
	      <td>2016-11-29</td>
	      <td>人生就像是一场修行</td>
	    </tr>
	    <tr>
	      <td>许闲心</td>
	      <td>2016-11-28</td>
	      <td>于千万人之中遇见你所遇见的人，于千万年之中，时间的无涯的荒野里…</td>
	    </tr>
	  </tbody>
	</table>
<div id="page"></div>

 <!-- 弹出层 --> 
  <div class="layelAdd" style="display: none;">
	  	<form class="layui-form" action="" style="margin-top: 20px;">
		  <div class="layui-form-item">
		   		 <label class="layui-form-label">bean名称</label>
			    <div class="layui-input-block">
			      <input type="text" name="beanName" required  lay-verify="required" placeholder="请输入bean名称" autocomplete="off" class="layui-input" style="width: 300px;">
			    </div>
		  </div>
		   <div class="layui-form-item">
		   		<label class="layui-form-label">方法名称</label>
			    <div class="layui-input-block">
			      <input type="text" name="methodName" required  lay-verify="required" placeholder="请输入方法名称" autocomplete="off" class="layui-input" style="width: 300px;">
			    </div>
		  </div>
		   <div class="layui-form-item">
		   		<label class="layui-form-label">参数</label>
			    <div class="layui-input-block">
			      <input type="text" name="params"  placeholder="参数"   class="layui-input" style="width: 300px;">
			    </div>
		  </div>
		   <div class="layui-form-item">
		   		<label class="layui-form-label">cron表达式</label>
			    <div class="layui-input-block">
			      <input type="text" name="cronExpression"  required  lay-verify="required"  placeholder="如   0 0/1 * * * ?"   class="layui-input" style="width: 300px;">
			    </div>
		  </div>
		   <div class="layui-form-item">
		   		<label class="layui-form-label">备注</label>
			    <div class="layui-input-block">
			      <input type="text" name="remark"  placeholder="备注"   class="layui-input" style="width: 300px;">
			    </div>
		  </div>
		  <div class="layui-form-item">
			    <div class="layui-input-block">
			      <button class="layui-btn" lay-submit lay-filter="formAdd">立即提交</button>
			      <button type="reset" class="layui-btn layui-btn-primary">重置</button>
			    </div>
		  </div>
	    </form>
 </div>
</div>
<script src="/lib/layui/layui.all.js"></script>
<script type="text/javascript">
//由于模块都一次性加载，因此不用执行 layui.use() 来加载对应模块，直接使用即可：
;!function(){
  var layer = layui.layer
  ,form = layui.form,table = layui.table,$=layui.jquery,laypage = layui.laypage;
  

  
  laypage.render({
	  elem: 'page'
	  ,count: 70 //数据总数，从服务端得到
	  ,layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
	  ,jump: function(obj, first){
	    //obj包含了当前分页的所有参数，比如：
	    console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
	    console.log(obj.limit); //得到每页显示的条数
	    
	    //首次不执行
	    if(!first){
	      //do something
	    }
	  }
	});
  $("#add").on("click",function(){	
		//页面层
		layer.open({
		  type: 1,
		  skin: 'layui-layer-rim', //加上边框
		  area: ['500px', '340px'], //宽高
		  content: $(".layelAdd").html()
		});
	});
  
 
  $(".del").on("click",function(){
	  var id=$(this).attr("data-id");
	  layer.confirm('确定要删除？', {
	    btn: ['确认','取消']
	  }, function(){
			 $.ajax({
		            url: "/delUser",
		            dataType: "json",
		            type: "post",
		            data:{id:id},
		            success: function (data) {
		                if (data.code == 0) {
		                	location.reload();
		                }else{
		                	layer.msg(data.msg);
		                }
		            }
		        });
	  }, function(){
	    
	  });
	});
  
  //监听提交
  form.on('submit(formAdd)', function(data){
	  var name=data.field.name;
	  var password=data.field.password;
	  $.ajax({
          url: "/saveUser",
          dataType: "json",
          type: "post",
          data:{name:name,password:password},
          success: function (data) {
              if (data.code == 0) {
            	  location.reload();
              }else{
              	layer.msg(data.msg);
              }
          }
      });  
  });
  
}();

</script>
</body>
</html>